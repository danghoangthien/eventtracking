<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Hypergrowth | Admin</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/style.css">
    <link rel="stylesheet" href="dist/css/animate.css">
    <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
	<!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
	<!-- jvectormap -->
    <link rel="stylesheet" href="plugins/jvectormap/jquery-jvectormap-1.2.2.css">

  </head>
<body class="fixed-sidebar"> <!-- mini-navbar for collapsed sidebar, fixed-sidebar for fixed--> 
    <div id="wrapper">
		
		<!-- sidebar -->
		<nav class="navbar-default navbar-static-side" role="navigation">
			<div class="sidebar-collapse">
				<ul class="nav metismenu" id="side-menu" style="display: block;">
					<li class="nav-header">
						<div class="dropdown profile-element"> 
							<div class="user-panel">
								<span class="image">
									<img alt="image" class="img-circle" src="img/samuelchan.jpg">
								</span>
							</div>
							<a data-toggle="dropdown" class="dropdown-toggle" href="#">
								<span class="clear"> 
									<span class="block m-t-xs"> 
										<strong class="font-bold">Samuel Chan</strong>
									 </span> 
									 <small>Member since Jun. 2015</small>
									 <span class="text-muted text-xs block">Warehouse Admin 
										<b class="caret"></b>
									</span> 
								</span> 
							</a>
							<ul class="dropdown-menu animated fadeInRight m-t-xs">
								<li><a href="#">Edit Profile</a></li>
								<li><a href="#">Sign Out</a></li>
							</ul>
						</div>
						<div class="logo-element">
							<span class="logo-mini"><img src="img/hypergrowth_small_transparent_16x35.png"></span>
						</div>
					</li>
					<li class="active">
						<a href="da.html">
							<i class="fa fa-bar-chart-o"></i> <span>Data Acquisition</span>
						</a>
					</li>
					<li>
						<a href="#">
							<i class="fa  fa-clone"></i> <span>Client App Title</span>
						</a>
					</li>
					<li>
						<a href="cm.html">
							<i class="fa fa-user-secret"></i> <span>Client Management</span>
						</a>
					</li>
					<li>
						<a href="uam.html">
							<i class="fa fa-sitemap"></i> <span>User Access Management</span>
						</a>
					</li>
					<li>
						<a href="#">
							<i class="fa fa-laptop"></i> 
							<span class="nav-label">Infrastructure Monitor</span> 
							<span class="fa arrow"></span>
						</a>
						<ul class="nav nav-second-level collapse">
							<li><a href="#">ELB</a></li>
							<li><a href="#">EC2</a></li>
							<li><a href="#">Redshift</a></li>
							<li><a href="#">SQS</a></li>
						</ul>
					</li>
				</ul>
			</div>
		</nav>
		<!-- /.sidebar -->

		<!-- Content Wrapper. Contains page content -->
		<!--class content-wrapper for full width without sidebar, and gray-bg sidebar-content for right sidebar-->
		<div id="page-wrapper" class="content-wrapper">
		
			<!--top bar-->
			<div class="row">
				<nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
					<div class="navbar-header">
						<a class="navbar-minimalize  minimalize-styl-2 btn btn-default" href="#"><i class="fa fa-bars"></i> </a>
					</div>
					<ul class="nav navbar-top-links navbar-right">
						<li>
							<span class="m-r-sm welcome-message">Welcome to Warehouse Admin</span>
						</li>
						<li>
							<a href="index-admin.html">
								<i class="fa fa-sign-out"></i> Log out
							</a>
						</li>
					</ul>

				</nav>
			</div>
			<!--End top bar-->
			
			<!-- Main Content -->
			<div class="wrapper wrapper-content">
				<div class="row">
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title">
                                <h5 class="font-bold">Total User Profiles</h5>
                            </div>
                            <div class="ibox-content">
								<h1 class="no-margins" id="total_profiles"></h1>
								<div class="font-bold">profiles</div>
							</div>
                        </div>
					</div>
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title">
                                <h5 class="font-bold">Total iOS Profiles</h5>
                            </div>
                            <div class="ibox-content">
								<h1 class="no-margins" id="total_ioscount"></h1>
								<div class="font-bold">profiles</div>
							</div>
                        </div>
					</div>
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title">
                                <h5 class="font-bold">Total Android Profiles</h5>
                            </div>
                            <div class="ibox-content">
								<h1 class="no-margins" id="total_androidcount"></h1>
								<div class="font-bold">profiles</div>
							</div>
                        </div>
					</div>
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title">
                                <h5 class="font-bold">Total Data Sources</h5>
                            </div>
                            <div class="ibox-content">
								<h1 class="no-margins" id="total_datasources"></h1>
								<div class="font-bold">sources</div>
							</div>
                        </div>
					</div>	
				</div>
				<div class="row">
					<div class="col-lg-9">
                        <div class="ibox float-e-margins">
							<div class="ibox-title">
                                <h5 class="font-bold">Profile Breakdown by Data Sources</h5>
                            </div>
                            <div class="ibox-content">
								<div class="row">
									<div class="col-md-9">
										<div id="ProfileBreakdownbyAppSourcePlatform" style="min-width: 210px; height: 450px;margin-top:20px;"></div>
									</div>	
									<div class="col-md-3">
										<div id="ProfileBreakdownbyAppSource" style="height:400px"></div>
									</div>
								</div>
							</div>
                        </div>
                    </div>
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-content" style="padding-top:20px">
								<h2 class="font-bold text-navy" id="">Recent Logins</h2>
                                <ul style="list-style: none outside none;padding:0">
                                    <li class="divider"></li>
                                    <li>
                                        <h3 class="m-b-xs text-navy">liputan6</h3>
                                        <div>March 29 at 5:26pm</div>
                                        <div>101.99.29.31 </div>
                                        <div>Jakarta, Indonesia</div>
                                        <div>Firefox on Windows 8.1</div>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <h3 class="m-b-xs text-navy">tiketcom</h3>
                                        <div>March 30 at 1:26am</div>
                                        <div>132.1.349.12 </div>
                                        <div>Ho Chi Minh City, Vietnam</div>
                                        <div>Chrome on Windows 7</div>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <h3 class="m-b-xs text-navy">alkemisgames</h3>
                                        <div>March 12 at 12:05pm</div>
                                        <div>191.201.67.23 </div>
                                        <div>Singapore, Singapore</div>
                                        <div>Chrome on Windows 7</div>
                                    </li>
                                    <li class="divider"></li>
                                </ul>
							</div>
						</div>
					</div>
				</div>
				
				<div class="row">
					<div class="col-lg-9">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
								<h5 class="font-bold">Profile Breakdown by Country</h5>
							</div>
							<div class="ibox-content">
								<div class="row">
									<div class="col-md-12">
										<div class="col-md-6">
											<select id="sel_platform" class="form-control">
												<option value="Android">Android</option>
												<option value="iOS">iOS</option>
											</select>
										</div>
									</div>
									<div class="col-md-6" id="ProfileBreakdownbyCountry_ctn" style="margin-top:20px">
										<div id="ProfileBreakdownbyCountry" style="height: 237px;"></div>
									</div>
									<div class="col-md-6">
										<div id="ProfileBreakdownbyCountryMap" style="height: 237px;"></div>
									</div>
								</div>

                            </div>
                        </div>
                    </div>
				</div>
								
			</div>
			<!--End Main Content-->
			
			<div class="footer">
				<div class="pull-right">
					<b>Version</b> 1.1.0
				</div>
				<div>
					<strong>Copyright &copy; 2016 <a href="http://www.hypergrowth.co"> HyperGrowth Pte Ltd</a>.</strong> All rights reserved.
				</div>
			</div>
			
      </div><!-- /.content-wrapper -->

    </div><!-- ./wrapper -->

    <!-- jQuery 2.1.4 -->
    <script src="plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- jQuery UI 1.11.4 -->
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.5 -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- Slimscroll -->
    <script src="plugins/slimScroll/jquery.slimscroll.min.js"></script>
	<!-- ChartJS 1.0.1 -->
    <script src="plugins/chartjs/Chart.min.js"></script>
    <!-- FastClick -->
    <script src="plugins/fastclick/fastclick.min.js"></script>
	<!-- Metis Menu -->
    <script src="plugins/metisMenu/jquery.metisMenu.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/app.min.js"></script>
	<script src="dist/js/inspinia.js"></script>
	<!-- jvectormap -->
    <script src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <!-- page script -->
	<script src="plugins/highcharts/highcharts.js"></script>
	<script src="plugins/highcharts/exporting.js"></script>
	
	<script>
      $(document).ready(function() {
	  
	  	var appidplatform_dt = "http://52.27.159.130/app_dev.php/analytics/metadata/profiles_breakdown_by_appidplatform";
		var clientlist_dt = "http://52.27.159.130/app_dev.php/analytics/metadata/client_list";
		
		$.getJSON(appidplatform_dt, function (json) {
			//set variables as array
			var app_id = [];
			var android_profile_count = [];
			var android_appid = [];
			var ios_profile_count = [];
			var ios_appid = [];
			
			//push json result into array object
			for (i = 0; i < json.data.length; i++) {
				app_id.push(json.data[i].app_id);
				if (json.data[i].platform == "Android" ){
					android_profile_count.push(json.data[i].profile_count);
					android_appid.push(json.data[i].app_id);
				}
				if (json.data[i].platform == "iOS" ){
					ios_profile_count.push(json.data[i].profile_count);
					ios_appid.push(json.data[i].app_id);
				}
			};
			
			//get client list
			$.getJSON(clientlist_dt, function (json) {
				var client_app = [];
				var client_name = [];
				
				//replace app id with client name
				for (i = 0; i < json.data.length; i++) {
					client_app.push(json.data[i].client_app);
					client_name.push(json.data[i].client_name);
				};
				for (i = 0; i < client_app.length; i++) {
					var string = client_app[i];
					for (a = 0; a < android_appid.length; a++){
						var substring = android_appid[a];
						if (string.indexOf(substring) > -1)
						{
							android_appid[a] = client_name[i];
							android_profile_count[a] = client_name[i]+':'+android_profile_count[a];
						}
					}
					for (b = 0; b < ios_appid.length; b++){
						var substring = ios_appid[b];
						if (string.indexOf(substring) > -1)
						{
							ios_appid[b] = client_name[i];
							ios_profile_count[b] = client_name[i]+':'+ios_profile_count[b];
						}
					}
				};
				
				//Apply value = 0 if app doesn't have either android or ios
				for (i = 0; i < client_name.length; i++) {
					if ($.inArray( client_name[i], ios_appid) == -1){
						ios_appid.push(client_name[i]);
						ios_profile_count.push(client_name[i]+':'+0);
					}
					if ($.inArray( client_name[i], android_appid) == -1){
						android_appid.push(client_name[i]);
						android_profile_count.push(client_name[i]+':'+0);
					}
				}
				
				ios_profile_count = ios_profile_count.sort();
				android_profile_count = android_profile_count.sort();
				var ios_count = [];
				var android_count = [];
				
				// Trim Text and get only Device Count
				for (i = 0; i < ios_profile_count.length; i++) {
					ios_count.push(eval(ios_profile_count[i].substring(ios_profile_count[i].indexOf(':') +1)));
				}
				for (i = 0; i < android_profile_count.length; i++) {
					android_count.push(eval(android_profile_count[i].substring(android_profile_count[i].indexOf(':') +1)));
				}
				
				//Get Data for Summary Rows
				var total_ioscount = eval(ios_count.join('+'));
				var total_androidcount = eval(android_count.join('+'));
				var total_devicecount = parseInt(total_ioscount) + parseInt(total_androidcount);
				var total_datasources = parseInt(client_name.length);
				
				$("#total_datasources").text(addThousandsSeparator(total_datasources));
				$("#total_ioscount").text(addThousandsSeparator(total_ioscount));
				$("#total_androidcount").text(addThousandsSeparator(total_androidcount));
				$("#total_profiles").text(addThousandsSeparator(total_devicecount));
				//$("#total_devicecount").text(addThousandsSeparator(total_devicecount));
				
				
				//-------------
				//- COLUMN CHART -
				//-------------
				//Render column Chart
				
				Highcharts.setOptions({
					lang: {
						thousandsSep: ','
					}
				});
				
				$('#ProfileBreakdownbyAppSourcePlatform').highcharts({
					chart: {
						type: 'bar',
						backgroundColor: 'transparent'
					},
					title: {
						text: ''
					},
					xAxis: {
						categories: client_name,
						crosshair: true,
						gridLineColor: '#D3D3D3',
            			gridLineWidth: 1
					},
					yAxis: {
						min: 0,
						title: {
							text: ''
						},
						gridLineColor: '#D3D3D3',
            			gridLineWidth: 1
					},
					tooltip: {
						headerFormat: '<span style="font-weight:bold">{point.key}</span><table>',
						pointFormat: '<tr><td style="padding:0">{series.name}: </td>' +
							'<td style="padding:0"><b>{point.y:,.0f} profiles</b></td></tr>',
						footerFormat: '</table>',
						shared: true,
						useHTML: true
					},
					plotOptions: {
						bar: {
							pointPadding: 0.1,
							borderWidth: 0,
							dataLabels: {
								enabled: false
							},
							groupPadding: 0
						}
					},
					series: [{
						name: 'Android',
						data: android_count,
						pointWidth: 15
	
					}, {
						name: 'iOS',
						data: ios_count,
						pointWidth: 14
					}],
					colors: ["#2E3F4E", "#456f90"],
					credits: {
					  enabled: false
					},
					exporting: {
						enabled: false
					}
				}); // END COLUMN CHART //
				
				//-------------
				//- PIE CHART -
				//-------------
				//Render Pie Chart
				
				var ProfileCountbyAppSource = [];
				for (i = 0; i < client_name.length; i++) {
					count = parseInt(ios_count[i])+parseInt(android_count[i]);
					ProfileCountbyAppSource.push(count);
				}
				var PieChartValue = ProfileCountbyAppSource;
				var PieChartLabel = client_name;
				var ProfileBreakdownbyAppSource_Data = [];
				for (i = 0; i < client_name.length; i++) {
					var PieChartData = {y: PieChartValue[i], name: PieChartLabel[i]};
					ProfileBreakdownbyAppSource_Data.push(PieChartData);
				}
				
				
				$('#ProfileBreakdownbyAppSource').highcharts({
					chart: {
						backgroundColor: 'rgba(0,0,0,0)',
						plotBorderWidth: null,
						plotShadow: false,
						type: 'pie'
					},
					title: {
						text: ''
					},
					tooltip: {
						pointFormat: '{series.name}: <b>{point.percentage:,.0f}%</b>'
					},
					plotOptions: {
						pie: {
							allowPointSelect: true,
							cursor: 'pointer',
							dataLabels: {
								enabled: false
							},
							showInLegend: true
						}
					},
					series: [{
						name: 'Sources',
						colorByPoint: true,
						data: ProfileBreakdownbyAppSource_Data
					}],
					credits: {
					  enabled: false
					},
					colors: ["#00c0ef","#333333","#2E3F4E","#f39c12","#3c8dbc","#800080","#00a65a","#f56954","#FF69B4"],
					exporting: {
						enabled: false
					}
				});
			})
		})
		
		var apiurl1 = "http://52.27.159.130/app_dev.php/analytics/metadata/profiles_breakdown_by_country";
		$.getJSON(apiurl1, function (json) {
			
			var device_ids = [];
			var android_device_id = [];
			var ios_device_id = [];
			var country_names = [];
			var android_countries = [];
			var ios_countries = [];
			var platforms = [];
						
			//push json result into array object
			for (i = 0; i < json.data.length; i++) {
				country_names.push(json.data[i].country_name);
				if (json.data[i].platform == "Android" ){
					android_device_id.push(json.data[i].device_id+":"+json.data[i].country_name);
					android_countries.push(json.data[i].country_name);
				}
				if (json.data[i].platform == "iOS" ){
					ios_device_id.push(json.data[i].device_id+":"+json.data[i].country_name);
					ios_countries.push(json.data[i].country_name);
				}
			};
			//Apply value = 0 if app doesn't have either android or ios
			for (i = 0; i < country_names.length; i++) {
				if ($.inArray( country_names[i], ios_countries) == -1){
					ios_device_id.push('0:'+country_names[i]);
				}
				if ($.inArray( country_names[i], android_countries) == -1){
					android_device_id.push('0:'+country_names[i]);
				}
			}
			
			var countrydata = [];
			var deviceset = [];
			$("#sel_platform").change(function () {
				var valueSelected = "";
				$( "select option:selected" ).each(function() {
					valueSelected = $( this ).text();
					var resetCanvas = function(){
						$('#ProfileBreakdownbyCountry').remove(); // this is my <canvas> element
						$('#ProfileBreakdownbyCountry_ctn').append('<canvas id="ProfileBreakdownbyCountry"><canvas>');
						canvas = document.querySelector('#ProfileBreakdownbyCountry');
						ctx = canvas.getContext('2d');
						ctx.canvas.width = $('#ProfileBreakdownbyCountry').width(); // resize to parent width
						ctx.canvas.height = $('#ProfileBreakdownbyCountry').height(); // resize to parent height
						var x = canvas.width/2;
						var y = canvas.height/2;
						ctx.font = '10pt Verdana';
						ctx.textAlign = 'center';
						ctx.fillText('Profile Breakdown by Country Chart', x, y);
					};
					if (valueSelected === 'Android') {
						deviceset = [];
						$('#ProfileBreakdownbyCountryMap').empty();
						//resetCanvas();
						var set = android_device_id.sort(naturalCompare);
						deviceset.push(set);					
					}
					if (valueSelected === 'iOS') {
						deviceset = [];
						$('#ProfileBreakdownbyCountryMap').empty();
						//resetCanvas();
						var set = ios_device_id.sort(naturalCompare);
						deviceset.push(set);
					}
					transferdt(deviceset[0]);
				});
			}).change();
			
			function transferdt(a){
				countrydata = a;
				
				// Trim Text and Separate Country and Device Counts
				var MapDeviceCounts = [];
				var MapCountry = [];
				for (i = 0; i < countrydata.length; i++) {
					MapCountry.push(countrydata[i].substring(countrydata[i].indexOf(':') +1));
					MapDeviceCounts.push(eval(countrydata[i].substring(0, countrydata[i].indexOf(':'))));
				}
				
				//Data for Country Chart
				var CountryChartLabel = MapCountry.slice(0,10);
				var CountryChartValue = MapDeviceCounts.slice(0,10);
				//console.log(CountryChartLabel);
				//console.log(CountryChartValue);
				
				var Worldmap = [];
				for (i = 0; i < 20; i++) {
					var display = {};
					var a = MapCountry[i];
					var b = parseInt(MapDeviceCounts[i]);
					display[a] = b;
					Worldmap.push(display);
				}
				var obj0 = Worldmap[0];var obj1 = Worldmap[1];
				var obj2 = Worldmap[2];var obj3 = Worldmap[3];
				var obj4 = Worldmap[4];var obj5 = Worldmap[5];
				var obj6 = Worldmap[6];var obj7 = Worldmap[7];
				var obj8 = Worldmap[8];var obj9 = Worldmap[9];
				var obj10 = Worldmap[10];var obj11 = Worldmap[11];
				var obj12 = Worldmap[12];var obj13 = Worldmap[13];
				var obj14 = Worldmap[16];var obj15 = Worldmap[15];
				var obj16 = Worldmap[16];var obj17 = Worldmap[17];
				var obj18 = Worldmap[18];var obj19 = Worldmap[19];
				// Merge object2 into object1
				$.extend(obj0,obj1,obj2,obj3,obj4,obj5,obj6,obj7,obj8,obj9,
				obj10,obj11,obj12,obj13,obj14,obj15,obj16,obj17,obj18,obj19
				);
				var WorldmapData = obj0;
				var CountryProfilesData = WorldmapData;
				//console.log(CountryProfilesData);
								
				$('#ProfileBreakdownbyCountryMap').vectorMap({
					map: 'world_mill_en',
					backgroundColor: "transparent",
					regionStyle: {
					  initial: {
						fill: '#eeeeee',
						"fill-opacity": 1,
						stroke: 'none',
						"stroke-width": 0,
						"stroke-opacity": 1
					  }
					},
					series: {
					  regions: [{
						  values: CountryProfilesData,
						  scale: ["#c0c5c9", "#2e3f4e"],
						  normalizeFunction: 'polynomial'
						}]
					},
					onRegionLabelShow: function (e, el, code) {
					  if (typeof CountryProfilesData[code] != "undefined")
						el.html(el.html() + ': ' + addThousandsSeparator(CountryProfilesData[code]) + ' profiles');
					}
				});
				
				//BarChart
				
				$('#ProfileBreakdownbyCountry').highcharts({
					chart: {
						type: 'column',
						backgroundColor: 'transparent'
					},
					title: {
						text: ''
					},
					xAxis: {
						categories: CountryChartLabel,
						crosshair: true,
						gridLineColor: '#D3D3D3',
            			gridLineWidth: 1
					},
					yAxis: {
						min: 0,
						title: {
							text: ''
						},
						gridLineColor: '#D3D3D3',
            			gridLineWidth: 1
					},
					tooltip: {
						headerFormat: '<span style="font-weight:bold">{point.key}</span><table>',
						pointFormat: '<tr><td style="padding:0"></td>' +
							'<td style="padding:0"><b>{point.y:,.0f} profiles</b></td></tr>',
						footerFormat: '</table>',
						shared: true,
						useHTML: true
					},
					plotOptions: {
						column: {
							pointPadding: 0.2,
							borderWidth: 0
						}
					},
					series: [{
						name: 'Country',
						data: CountryChartValue,
						pointWidth: 22
					}],
					colors: ["#2E3F4E", "#456f90"],
					credits: {
					  enabled: false
					},
					exporting: {
						enabled: false
					}
				});
			};
			
		});
		
		//Add Thousands Separator
		function addThousandsSeparator(input) {
			var output = input
			if (parseFloat(input)) {
				input = new String(input); // so you can perform string operations
				var parts = input.split("."); // remove the decimal part
				parts[0] = parts[0].split("").reverse().join("").replace(/(\d{3})(?!$)/g, "$1,").split("").reverse().join("");
				output = parts.join(".");
			}
			return output;
		}
		// Sort number with string
		function naturalCompare(b, a) {
			var ax = [], bx = [];

			a.replace(/(\d+)|(\D+)/g, function(_, $1, $2) { ax.push([$1 || Infinity, $2 || ""]) });
			b.replace(/(\d+)|(\D+)/g, function(_, $1, $2) { bx.push([$1 || Infinity, $2 || ""]) });
			
			while(ax.length && bx.length) {
				var an = ax.shift();
				var bn = bx.shift();
				var nn = (an[0] - bn[0]) || an[1].localeCompare(bn[1]);
				if(nn) return nn;
			}
			return ax.length - bx.length;
		}
		//PieChart Options
		var pieOptions = {
			//Boolean - Whether we should show a stroke on each segment
			segmentShowStroke: true,
			//String - The colour of each segment stroke
			segmentStrokeColor: "#fff",
			//Number - The width of each segment stroke
			segmentStrokeWidth: 2,
			//Number - The percentage of the chart that we cut out of the middle
			percentageInnerCutout: 50, // This is 0 for Pie charts
			//Number - Amount of animation steps
			animationSteps: 100,
			//String - Animation easing effect
			animationEasing: "easeOutBounce",
			//Boolean - Whether we animate the rotation of the Doughnut
			animateRotate: true,
			//Boolean - Whether we animate scaling the Doughnut from the centre
			animateScale: false,
			//Boolean - whether to make the chart responsive to window resizing
			responsive: true,
			// Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
			maintainAspectRatio: true,
			//String - A legend template
			legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>"
		};

    });
    </script>
  </body>
</html>
